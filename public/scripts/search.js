const DEFAULT_INDEX=0;document.addEventListener("DOMContentLoaded",async e=>{const t={wrapSearchPostResultSnippet:e=>{if(e.length>0){e.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime());let t='\n          <h4>文章</h4>\n          <ul class="catelog-items">\n        ';return e.forEach(e=>{t+=`\n            <li itemprop="name">\n              <time itemprop="datePublished" datetime="${e.rawDate}">${e.date}</time> &nbsp;|&nbsp; <a href="${e.url}" itemprop="url">${e.title}</a>\n            </li>\n          `}),`${t}</ul>`}return!1},wrapSearchTagResultSnippet:e=>{if(e.length>0){let t='\n          <h4>标签</h4>\n          <div class="tag-item">\n        ';return e.forEach(e=>{t+=`\n            <a href="/tags/${e.tagName}" itemprop="url">#${e.tagName}</a>\n          `}),`${t}</div>`}return!1}},a=document.querySelectorAll(".search-result-container"),r=document.querySelector(".input-search"),n=document.querySelector("div.no-result"),s=document.querySelector(".submit-search");r.addEventListener("keydown",e=>{13===e.keyCode&&s.click()}),s.addEventListener("click",async e=>{const s=e.target||e.srcElement,l=r.value;if(l){s.disabled=!0,s.innerText="...";try{const r=await axios.get("/graphql",{params:{query:"\n  query searchContent($searchKey: String!) {\n    searchPostsByKey(key: $searchKey) {\n      title\n      url\n      date\n      rawDate\n    }\n    searchTagsByKey(key: $searchKey) {\n      tagName\n    }\n  }\n            ",variables:{searchKey:l}}});if(Array.isArray(r.data.errors)&&r.data.errors.length>0)return void alert(r.data.errors[0].message);const{data:{data:{...i}}}=r;let c=[];a.forEach(e=>{const{type:a}=e.dataset;c.push({html:t[`wrapSearch${a}ResultSnippet`].call(this,i[`search${a}sByKey`]),type:a})}),0===c.filter(e=>e.html).length?(a.forEach(e=>{e.innerHTML=""}),n.style.display="block"):(n.style.display="none",a.forEach(e=>{const{type:t}=e.dataset,a=c.filter(e=>e.type===t)[0].html;a&&e.insertAdjacentHTML("afterbegin",a)}))}catch(e){console.error(e.message)}finally{s.disabled=!1,s.innerText="搜索"}}else alert(":( Nothing to search!")})});